g0 <- sample_pa(n0,directed = F)
library(igraph)
library(gridExtra)
library(ggplot2)
n0<-100
maxNumberOfAttacks<-10
attackSeq<-seq(0,maxNumberOfAttacks,by=2)
set.seed(123)
g0 <- sample_pa(n0,directed = F)
V(g0)$name <-V(g0)
g0
g0+edge("1","2")
g0["1","2"]
g0["2","1"]
g0["1","2"]
getCombinations<-function(g){
bts<-sort(betweenness(g,directed = F),decreasing = T)
#combinations<-list()
#n<-names(bts)
combinations<-combn(bts,2,simplify = F)
a<-sapply(combinations,sum)
combinations[order(-a)]
}
getCombinations(g0)
sapply(getCombinations,names)
sapply(getCombinations(g0),names)
head(sapply(getCombinations(g0),names))
names(getCombinations(g0)[[1]])
names(getCombinations(g0))
sapply(getCombinations(g0),names)
head(getCombinations(g0))
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
library(igraph)
library(gridExtra)
library(ggplot2)
n0<-100
maxNumberOfAttacks<-10
attackSeq<-seq(0,maxNumberOfAttacks,by=2)
set.seed(123)
g0 <- sample_pa(n0,directed = F)
V(g0)$name <-V(g0)
#gr<-erdos.renyi.game(n=n0,p.or.m = ecount(g0),type = "gnm")
#V(gr)$name <-V(gr)
lengthOption<-"FL"
algorithm<-"MV"
attackMethod<-"BA"
Linklimit<-20
limitSeq<-seq(10,50,by=2)
#############functions###############
findAttack<-function(g,k){
if(k!=0){
a1<-vector()
z<-1
bts<-betweenness(g,directed = F)
od<-sort(unique(bts),decreasing = T)
a1<-names(subset(bts,bts==od[z]))
while(length(a1)<k){
z<-z+1
a1<-c(a1,names(subset(bts,bts==od[z])))
}
if(length(a1)>k){
a1<-a1[1:k]
}
a1
}
else
NA
}
findEfficiency<-function(g){
dtr<-distance_table(g,directed = F)$res
e<-2*sum(dtr*(1/(1:length(dtr))))/(vcount(g)*(vcount(g)-1))
e
}
findVulnerability<-function(g,at){
if(is.na(at))
0
else{
g2<-delete.vertices(g,at)
(1-(findEfficiency(g2)/findEfficiency(g)))
}
}
getCombinations<-function(g){
bts<-sort(betweenness(g,directed = F),decreasing = T)
#combinations<-list()
#n<-names(bts)
combinations<-combn(bts,2,simplify = F)
a<-sapply(combinations,sum)
combinations[order(-a)]
}
graphAfterAttack<-function(g,at){
if(is.na(at[1]))
g
else
delete.vertices(g,at)
}
findRobustness<-function(g){
vuls<-vector()
l<-vcount(g)
for(i in 1:l){
at<-findAttack(g,i)
vuls<-c(vuls,findVulnerability(g,at))
}
mean(vuls)
}
findRobustness(g0)
l<-vcount(g0)
l
findRobustness<-function(g){
vuls<-vector()
l<-vcount(g)
for(i in 1:(l-1)){
at<-findAttack(g,i)
vuls<-c(vuls,findVulnerability(g,at))
}
mean(vuls)
}
findRobustness(g0)
findRobustness<-function(g){
vuls<-vector()
l<-vcount(g)
for(i in 1:(l-2)){
at<-findAttack(g,i)
vuls<-c(vuls,findVulnerability(g,at))
}
print(vuls)
mean(vuls)
}
findRobustness(g0)
findAttack(g,99)
findRobustness<-function(g){
vuls<-vector()
l<-vcount(g)
for(i in 1:(l-1)){
at<-findAttack(g,i)
vuls<-c(vuls,findVulnerability(g,at))
}
print(vuls)
mean(vuls)
}
findRobustness(g0)
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
findRobustness(g0)
warnings()
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
r0<-findRobustness(g0)
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
name
m
g[name[1],name[2]]
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
m
l
r1
r0
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
g
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
findRobustness<-function(g){
vuls<-vector()
l<-vcount(g)
for(i in 1:(l-2)){
at<-findAttack(g,i)
vuls<-c(vuls,findVulnerability(g,at))
}
vuls*((l-2):1)/sum(1:(l-2))
}
findRobustness(g0)
findRobustness<-function(g){
vuls<-vector()
l<-vcount(g)
for(i in 1:(l-2)){
at<-findAttack(g,i)
vuls<-c(vuls,findVulnerability(g,at))
}
sum(vuls*((l-2):1))/sum(1:(l-2))
}
findRobustness(g0)
findRobustness<-function(g){
vuls<-vector()
l<-vcount(g)
for(i in 1:(l-2)){
at<-findAttack(g,i)
vuls<-c(vuls,findVulnerability(g,at))
}
#sum(vuls*((l-2):1))/sum(1:(l-2))
mean(vuls)
}
findRobustness(g0)
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
(r1+0.01)<r0
r1
r0
r1+0.01<r0
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
source('C:/Users/marayati/Google Drive/Myself/Research/implementation/robustnessTest/test4.R')
